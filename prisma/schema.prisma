// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

enum StatusType {
  ACTIVE
  INACTIVE
}

enum RoleType {
  ADMIN
  MEMBER
}

model User {
  id String @id @default(uuid())

  order         Int        @default(autoincrement())
  name          String?
  email         String     @unique
  emailVerified Boolean    @default(false)
  image         String?
  role          RoleType   @default(MEMBER)
  status        StatusType @default(ACTIVE)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  documents     Document[]
  generations   Generation[]
  presentations Presentation[]
  sessions      Session[]
  accounts      Account[]

  @@map("users")
}

model Account {
  id                String  @id @default(uuid())
  order             Int     @default(autoincrement())
  provider          String  @default("credential")
  providerAccountId String?
  userId            String
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  accessToken          String?
  refreshToken         String?
  idToken              String?
  accessTokenExpiresAt DateTime?
  scope                String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  accountId             String
  providerId            String
  refreshTokenExpiresAt DateTime?
  password              String?

  @@unique([provider, providerAccountId])
  @@index([userId])
  @@map("accounts")
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
  @@map("verification_tokens")
}

model Session {
  id     String @id @default(uuid())
  userId String

  expiresAt DateTime
  token     String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  ipAddress String?
  userAgent String?

  @@index([userId])
  @@map("sessions")
}

model Verification {
  id String @id @default(uuid())

  identifier String
  value      String
  expiresAt  DateTime

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([identifier])
  @@map("verifications")
}

enum VisibilityType {
  PUBLIC
  PRIVATE
}

model Document {
  id     String @id @default(uuid())
  order  Int    @default(autoincrement())
  userId String

  name       String
  visibility VisibilityType @default(PRIVATE)
  status     StatusType     @default(ACTIVE)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user        User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  generations Generation[]

  @@index([userId])
  @@map("documents")
}

enum ScopeType {
  MULTI_PAGE
  SINGLE_PAGE
}

enum LanguageType {
  EN // English (default)
  ES // Spanish
  FR // French
  DE // German
  IT // Italian
  PT // Portuguese
  RU // Russian
  ZH // Chinese
  JA // Japanese
  KO // Korean
}

enum AspectRatio {
  RATIO_16_9 // Widescreen (default)
  RATIO_4_3 // Standard
  RATIO_9_16 // Vertical (Mobile/Stories)
  RATIO_1_1 // Square
}

enum ToneType {
  FORMAL
  INFORMAL
  FRIENDLY
  PROFESSIONAL
  HUMOROUS
}

enum AmountType {
  MINIMAL
  CONCISE
  DETAILED
  EXTENSIVE
}

enum AudienceType {
  AUTO
  GENERAL
  STUDENTS
  PROFESSIONALS
  ENTREPRENEURS
  MARKETERS
  DEVELOPERS
  DESIGNERS
  EDUCATORS
  HEALTHCARE_PROVIDERS
  FINANCIAL_ADVISORS
}

enum ScenarioType {
  AUTO
  GENERAL
  BUSINESS_PITCH
  EDUCATIONAL_LECTURE
  PRODUCT_DEMO
  TRAINING_SESSION
  MARKETING_CAMPAIGN
  TECHNICAL_PRESENTATION
  SALES_PITCH
  CONFERENCE_TALK
  WORKSHOP
  WEBINAR
}

enum ThemeType {
  LIGHT
  DARK
  CORPORATE
  CREATIVE
  MINIMALIST
  MODERN
  CLASSIC
}

enum SourceType {
  GENERATED
  EDITED
  CREATED
}

model Generation {
  id         String @id @default(uuid())
  order      Int    @default(autoincrement())
  documentId String
  userId     String

  source SourceType @default(GENERATED)

  scope       ScopeType    @default(MULTI_PAGE)
  tone        ToneType     @default(PROFESSIONAL)
  amount      AmountType   @default(CONCISE)
  audience    AudienceType @default(AUTO)
  scenario    ScenarioType @default(AUTO)
  theme       ThemeType    @default(LIGHT)
  language    LanguageType @default(EN)
  status      StatusType   @default(ACTIVE)
  quantity    Int          @default(1)
  aspectRatio String       @default("16_9")
  keywords    String[]     @default([])

  prompt     String @db.Text
  outlines   Json
  aiMetadata Json?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user          User           @relation(fields: [userId], references: [id], onDelete: Cascade)
  document      Document       @relation(fields: [documentId], references: [id], onDelete: Cascade)
  presentations Presentation[]

  @@index([documentId])
  @@index([userId])
  @@map("generations")
}

model Presentation {
  id           String @id @default(uuid())
  order        Int    @default(autoincrement())
  generationId String
  userId       String

  source SourceType @default(GENERATED)

  slug       String
  slides     Json
  aiMetadata Json?
  status     StatusType @default(ACTIVE)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  generation Generation @relation(fields: [generationId], references: [id], onDelete: Cascade)
  user       User       @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([generationId])
  @@index([userId])
  @@map("presentations")
}
